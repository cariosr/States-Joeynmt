2020-04-25 13:41:16,622 Hello! This is Joey-NMT.
2020-04-25 13:41:16,622 cfg.name                           : reverse_experiment
2020-04-25 13:41:16,622 cfg.data.src                       : src
2020-04-25 13:41:16,622 cfg.data.trg                       : trg
2020-04-25 13:41:16,622 cfg.data.train                     : test/data/mini_reverse/train
2020-04-25 13:41:16,622 cfg.data.dev                       : test/data/mini_reverse/dev
2020-04-25 13:41:16,623 cfg.data.test                      : test/data/mini_reverse/test
2020-04-25 13:41:16,623 cfg.data.level                     : word
2020-04-25 13:41:16,623 cfg.data.lowercase                 : False
2020-04-25 13:41:16,623 cfg.data.max_sent_length           : 25
2020-04-25 13:41:16,623 cfg.data.src_voc_min_freq          : 0
2020-04-25 13:41:16,623 cfg.data.src_voc_limit             : 100
2020-04-25 13:41:16,623 cfg.data.trg_voc_min_freq          : 0
2020-04-25 13:41:16,623 cfg.data.trg_voc_limit             : 100
2020-04-25 13:41:16,624 cfg.testing.beam_size              : 1
2020-04-25 13:41:16,624 cfg.testing.alpha                  : 1.0
2020-04-25 13:41:16,624 cfg.training.random_seed           : 42
2020-04-25 13:41:16,624 cfg.training.optimizer             : adam
2020-04-25 13:41:16,624 cfg.training.learning_rate         : 0.001
2020-04-25 13:41:16,624 cfg.training.learning_rate_min     : 0.0002
2020-04-25 13:41:16,624 cfg.training.weight_decay          : 0.0
2020-04-25 13:41:16,625 cfg.training.clip_grad_norm        : 1.0
2020-04-25 13:41:16,625 cfg.training.batch_size            : 10
2020-04-25 13:41:16,625 cfg.training.batch_type            : sentence
2020-04-25 13:41:16,625 cfg.training.scheduling            : plateau
2020-04-25 13:41:16,625 cfg.training.patience              : 5
2020-04-25 13:41:16,625 cfg.training.decrease_factor       : 0.5
2020-04-25 13:41:16,625 cfg.training.early_stopping_metric : eval_metric
2020-04-25 13:41:16,625 cfg.training.epochs                : 10
2020-04-25 13:41:16,625 cfg.training.validation_freq       : 10
2020-04-25 13:41:16,626 cfg.training.logging_freq          : 10
2020-04-25 13:41:16,626 cfg.training.eval_metric           : bleu
2020-04-25 13:41:16,626 cfg.training.model_dir             : mini_reverse_model
2020-04-25 13:41:16,626 cfg.training.overwrite             : True
2020-04-25 13:41:16,626 cfg.training.shuffle               : True
2020-04-25 13:41:16,626 cfg.training.use_cuda              : False
2020-04-25 13:41:16,626 cfg.training.max_output_length     : 10
2020-04-25 13:41:16,626 cfg.training.print_valid_sents     : [0, 3, 6]
2020-04-25 13:41:16,626 cfg.training.keep_last_ckpts       : 2
2020-04-25 13:41:16,627 cfg.model.initializer              : xavier
2020-04-25 13:41:16,627 cfg.model.embed_initializer        : normal
2020-04-25 13:41:16,627 cfg.model.embed_init_weight        : 0.1
2020-04-25 13:41:16,627 cfg.model.bias_initializer         : zeros
2020-04-25 13:41:16,627 cfg.model.init_rnn_orthogonal      : False
2020-04-25 13:41:16,627 cfg.model.lstm_forget_gate         : 0.0
2020-04-25 13:41:16,627 cfg.model.encoder.rnn_type         : lstm
2020-04-25 13:41:16,627 cfg.model.encoder.embeddings.embedding_dim : 16
2020-04-25 13:41:16,628 cfg.model.encoder.embeddings.scale : False
2020-04-25 13:41:16,629 cfg.model.encoder.hidden_size      : 24
2020-04-25 13:41:16,629 cfg.model.encoder.bidirectional    : True
2020-04-25 13:41:16,629 cfg.model.encoder.dropout          : 0.1
2020-04-25 13:41:16,629 cfg.model.encoder.num_layers       : 1
2020-04-25 13:41:16,629 cfg.model.decoder.rnn_type         : lstm
2020-04-25 13:41:16,629 cfg.model.decoder.embeddings.embedding_dim : 16
2020-04-25 13:41:16,629 cfg.model.decoder.embeddings.scale : False
2020-04-25 13:41:16,630 cfg.model.decoder.hidden_size      : 24
2020-04-25 13:41:16,630 cfg.model.decoder.dropout          : 0.1
2020-04-25 13:41:16,630 cfg.model.decoder.hidden_dropout   : 0.1
2020-04-25 13:41:16,630 cfg.model.decoder.num_layers       : 1
2020-04-25 13:41:16,630 cfg.model.decoder.input_feeding    : True
2020-04-25 13:41:16,630 cfg.model.decoder.init_hidden      : bridge
2020-04-25 13:41:16,630 cfg.model.decoder.attention        : luong
2020-04-25 13:41:16,630 cfg.dqn.epochs                     : 500
2020-04-25 13:41:16,631 cfg.dqn.sample_size                : 256
2020-04-25 13:41:16,631 cfg.dqn.lr                         : 5e-05
2020-04-25 13:41:16,631 cfg.dqn.egreed_max                 : 0.9
2020-04-25 13:41:16,631 cfg.dqn.egreed_min                 : 0.001
2020-04-25 13:41:16,631 cfg.dqn.gamma_max                  : 0.9
2020-04-25 13:41:16,631 cfg.dqn.gamma_min                  : 0.3
2020-04-25 13:41:16,631 cfg.dqn.nu_iter                    : 300
2020-04-25 13:41:16,631 cfg.dqn.mem_cap                    : 5000
2020-04-25 13:41:16,632 cfg.dqn.beam_min                   : 1
2020-04-25 13:41:16,632 cfg.dqn.beam_max                   : 50
2020-04-25 13:41:16,632 cfg.dqn.state_type                 : hidden
2020-04-25 13:41:16,632 cfg.dqn.reward_type                : bleu_batch
2020-04-25 13:41:16,632 cfg.dqn.nu_pretrain                : 0
2020-04-25 13:41:16,632 cfg.dqn.other_descrip              : _100_LSTM_
2020-04-25 13:41:16,632 We are using the reward named: bleu_batch
2020-04-25 13:41:16,633 As states we set the : hidden
2020-04-25 13:41:16,633 EPOCH 1
2020-04-25 13:41:16,634  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 13:41:21,413 EPOCH 2
2020-04-25 13:41:21,414  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 13:41:24,956 EPOCH 3
2020-04-25 13:41:24,956  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 13:41:24,983  As referece this first test on dev data. Is maded with the Q networks, initialized randomly : 
2020-04-25 13:41:25,078 Currently on the prediction.
2020-04-25 13:41:29,798 Optimal reward is: 99493.00
2020-04-25 13:41:29,805 On train
2020-04-25 13:41:29,806 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 13:41:29,806  3	 vs <s> 3 <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  2	 vs <s> 0 0 <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  1 0	 vs <s> <s> <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  1	 vs <s> 0 <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  2	 vs <s> <s> <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  4	 vs 0 0 <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  4 2	 vs 0 <s> <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  1 3	 vs 0 0 <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  4 3	 vs 0 <s> <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,806  3	 vs <s> <s> <s> <s> <s> <s> <s> <s> <s> <s>	
2020-04-25 13:41:29,948 r_total: 0.00 
2020-04-25 13:41:29,949 bleu score: 0.00
2020-04-25 13:41:49,556 EPOCH 4
2020-04-25 13:41:49,556  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 13:42:08,236 EPOCH 5
2020-04-25 13:42:08,238  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 13:42:27,716 EPOCH 6
2020-04-25 13:42:27,717  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:42:27,809  Copying the Q-Val on Q-tar on step: 1 
2020-04-25 13:42:27,935 Currently on the prediction.
2020-04-25 13:42:31,596 On train
2020-04-25 13:42:31,597 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 13:42:31,597  3	 vs 0 0	
2020-04-25 13:42:31,597  2	 vs 3 3 3 3 3 3 3	
2020-04-25 13:42:31,598  1 0	 vs 3 3 3	
2020-04-25 13:42:31,598  1	 vs 3 3 3 3 3 3 3 3	
2020-04-25 13:42:31,598  2	 vs 3	
2020-04-25 13:42:31,599  4	 vs 0 3	
2020-04-25 13:42:31,599  4 2	 vs 3 3	
2020-04-25 13:42:31,599  1 3	 vs 0 3	
2020-04-25 13:42:31,599  4 3	 vs 3 3	
2020-04-25 13:42:31,600  3	 vs 3	
2020-04-25 13:42:31,672 r_total: -3718.00 
2020-04-25 13:42:31,673 bleu score: 0.00
2020-04-25 13:42:48,739 EPOCH 7
2020-04-25 13:42:48,744  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:43:05,797 EPOCH 8
2020-04-25 13:43:05,797  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:43:23,789 EPOCH 9
2020-04-25 13:43:23,791  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:43:23,910  Copying the Q-Val on Q-tar on step: 2 
2020-04-25 13:43:23,973 Currently on the prediction.
2020-04-25 13:43:25,845 On train
2020-04-25 13:43:25,846 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 13:43:25,846  3	 vs 0 0	
2020-04-25 13:43:25,846  2	 vs 0	
2020-04-25 13:43:25,846  1 0	 vs 0	
2020-04-25 13:43:25,846  1	 vs 4	
2020-04-25 13:43:25,847  2	 vs 	
2020-04-25 13:43:25,847  4	 vs 0	
2020-04-25 13:43:25,847  4 2	 vs 4	
2020-04-25 13:43:25,847  1 3	 vs 0	
2020-04-25 13:43:25,847  4 3	 vs 	
2020-04-25 13:43:25,847  3	 vs 	
2020-04-25 13:43:25,882 r_total: 4637.08 
2020-04-25 13:43:25,882 bleu score: 4.52
2020-04-25 13:43:45,906 EPOCH 10
2020-04-25 13:43:45,912  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:44:05,442 EPOCH 11
2020-04-25 13:44:05,443  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:44:26,850 EPOCH 12
2020-04-25 13:44:26,851  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 13:44:27,003  Copying the Q-Val on Q-tar on step: 3 
2020-04-25 13:44:27,123 Currently on the prediction.
2020-04-25 13:44:29,812 On train
2020-04-25 13:44:29,812 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 13:44:29,812  3	 vs 0 0	
2020-04-25 13:44:29,812  2	 vs 4 4	
2020-04-25 13:44:29,813  1 0	 vs 4 4	
2020-04-25 13:44:29,813  1	 vs 4 4	
2020-04-25 13:44:29,813  2	 vs 4	
2020-04-25 13:44:29,813  4	 vs 0	
2020-04-25 13:44:29,813  4 2	 vs 4	
2020-04-25 13:44:29,813  1 3	 vs 0	
2020-04-25 13:44:29,814  4 3	 vs 4	
2020-04-25 13:44:29,814  3	 vs 4	
2020-04-25 13:44:29,857 r_total: 11092.24 
2020-04-25 13:44:29,857 bleu score: 9.15
2020-04-25 13:44:51,254 EPOCH 13
2020-04-25 13:44:51,255  beam_dqn : 1, egreed: 0.89, gamma:  0.84
