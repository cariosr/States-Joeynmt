2020-04-25 11:06:37,327 Hello! This is Joey-NMT.
2020-04-25 11:06:37,328 cfg.name                           : reverse_experiment
2020-04-25 11:06:37,329 cfg.data.src                       : src
2020-04-25 11:06:37,329 cfg.data.trg                       : trg
2020-04-25 11:06:37,329 cfg.data.train                     : test/data/mini_reverse/train
2020-04-25 11:06:37,329 cfg.data.dev                       : test/data/mini_reverse/dev
2020-04-25 11:06:37,330 cfg.data.test                      : test/data/mini_reverse/test
2020-04-25 11:06:37,330 cfg.data.level                     : word
2020-04-25 11:06:37,330 cfg.data.lowercase                 : False
2020-04-25 11:06:37,330 cfg.data.max_sent_length           : 25
2020-04-25 11:06:37,330 cfg.data.src_voc_min_freq          : 0
2020-04-25 11:06:37,331 cfg.data.src_voc_limit             : 100
2020-04-25 11:06:37,331 cfg.data.trg_voc_min_freq          : 0
2020-04-25 11:06:37,331 cfg.data.trg_voc_limit             : 100
2020-04-25 11:06:37,331 cfg.testing.beam_size              : 1
2020-04-25 11:06:37,332 cfg.testing.alpha                  : 1.0
2020-04-25 11:06:37,332 cfg.training.random_seed           : 42
2020-04-25 11:06:37,332 cfg.training.optimizer             : adam
2020-04-25 11:06:37,332 cfg.training.learning_rate         : 0.001
2020-04-25 11:06:37,332 cfg.training.learning_rate_min     : 0.0002
2020-04-25 11:06:37,332 cfg.training.weight_decay          : 0.0
2020-04-25 11:06:37,332 cfg.training.clip_grad_norm        : 1.0
2020-04-25 11:06:37,333 cfg.training.batch_size            : 10
2020-04-25 11:06:37,333 cfg.training.batch_type            : sentence
2020-04-25 11:06:37,333 cfg.training.scheduling            : plateau
2020-04-25 11:06:37,333 cfg.training.patience              : 5
2020-04-25 11:06:37,334 cfg.training.decrease_factor       : 0.5
2020-04-25 11:06:37,334 cfg.training.early_stopping_metric : eval_metric
2020-04-25 11:06:37,334 cfg.training.epochs                : 10
2020-04-25 11:06:37,334 cfg.training.validation_freq       : 10
2020-04-25 11:06:37,334 cfg.training.logging_freq          : 10
2020-04-25 11:06:37,335 cfg.training.eval_metric           : bleu
2020-04-25 11:06:37,335 cfg.training.model_dir             : mini_reverse_model
2020-04-25 11:06:37,335 cfg.training.overwrite             : True
2020-04-25 11:06:37,335 cfg.training.shuffle               : True
2020-04-25 11:06:37,336 cfg.training.use_cuda              : False
2020-04-25 11:06:37,336 cfg.training.max_output_length     : 10
2020-04-25 11:06:37,337 cfg.training.print_valid_sents     : [0, 3, 6]
2020-04-25 11:06:37,337 cfg.training.keep_last_ckpts       : 2
2020-04-25 11:06:37,338 cfg.model.initializer              : xavier
2020-04-25 11:06:37,338 cfg.model.embed_initializer        : normal
2020-04-25 11:06:37,338 cfg.model.embed_init_weight        : 0.1
2020-04-25 11:06:37,338 cfg.model.bias_initializer         : zeros
2020-04-25 11:06:37,338 cfg.model.init_rnn_orthogonal      : False
2020-04-25 11:06:37,339 cfg.model.lstm_forget_gate         : 0.0
2020-04-25 11:06:37,339 cfg.model.encoder.rnn_type         : lstm
2020-04-25 11:06:37,339 cfg.model.encoder.embeddings.embedding_dim : 16
2020-04-25 11:06:37,339 cfg.model.encoder.embeddings.scale : False
2020-04-25 11:06:37,340 cfg.model.encoder.hidden_size      : 24
2020-04-25 11:06:37,340 cfg.model.encoder.bidirectional    : True
2020-04-25 11:06:37,340 cfg.model.encoder.dropout          : 0.1
2020-04-25 11:06:37,341 cfg.model.encoder.num_layers       : 1
2020-04-25 11:06:37,341 cfg.model.decoder.rnn_type         : lstm
2020-04-25 11:06:37,341 cfg.model.decoder.embeddings.embedding_dim : 16
2020-04-25 11:06:37,341 cfg.model.decoder.embeddings.scale : False
2020-04-25 11:06:37,341 cfg.model.decoder.hidden_size      : 24
2020-04-25 11:06:37,342 cfg.model.decoder.dropout          : 0.1
2020-04-25 11:06:37,342 cfg.model.decoder.hidden_dropout   : 0.1
2020-04-25 11:06:37,342 cfg.model.decoder.num_layers       : 1
2020-04-25 11:06:37,343 cfg.model.decoder.input_feeding    : True
2020-04-25 11:06:37,343 cfg.model.decoder.init_hidden      : bridge
2020-04-25 11:06:37,343 cfg.model.decoder.attention        : luong
2020-04-25 11:06:37,344 cfg.dqn.epochs                     : 500
2020-04-25 11:06:37,344 cfg.dqn.sample_size                : 256
2020-04-25 11:06:37,344 cfg.dqn.lr                         : 5e-05
2020-04-25 11:06:37,345 cfg.dqn.egreed_max                 : 0.9
2020-04-25 11:06:37,345 cfg.dqn.egreed_min                 : 0.001
2020-04-25 11:06:37,345 cfg.dqn.gamma_max                  : 0.9
2020-04-25 11:06:37,345 cfg.dqn.gamma_min                  : 0.3
2020-04-25 11:06:37,346 cfg.dqn.nu_iter                    : 300
2020-04-25 11:06:37,346 cfg.dqn.mem_cap                    : 5000
2020-04-25 11:06:37,346 cfg.dqn.beam_min                   : 1
2020-04-25 11:06:37,346 cfg.dqn.beam_max                   : 50
2020-04-25 11:06:37,347 cfg.dqn.state_type                 : attention
2020-04-25 11:06:37,347 cfg.dqn.reward_type                : bleu_batch
2020-04-25 11:06:37,347 cfg.dqn.nu_pretrain                : 0
2020-04-25 11:06:37,347 cfg.dqn.other_descrip              : _100_LSTM_
2020-04-25 11:06:37,348 We are using the reward named: bleu_batch
2020-04-25 11:06:37,349 EPOCH 1
2020-04-25 11:06:37,351  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 11:06:41,113 EPOCH 2
2020-04-25 11:06:41,114  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 11:06:44,832 EPOCH 3
2020-04-25 11:06:44,833  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 11:06:49,558 EPOCH 4
2020-04-25 11:06:49,559  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 11:06:53,757 EPOCH 5
2020-04-25 11:06:53,758  beam_dqn : 1, egreed: 0.90, gamma:  0.84
2020-04-25 11:06:58,154 EPOCH 6
2020-04-25 11:06:58,155  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:02,719 EPOCH 7
2020-04-25 11:07:02,720  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:07,601 EPOCH 8
2020-04-25 11:07:07,602  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:11,609 EPOCH 9
2020-04-25 11:07:11,610  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:15,390 EPOCH 10
2020-04-25 11:07:15,391  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:19,347 EPOCH 11
2020-04-25 11:07:19,348  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:23,268 EPOCH 12
2020-04-25 11:07:23,275  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:27,211 EPOCH 13
2020-04-25 11:07:27,212  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:31,335 EPOCH 14
2020-04-25 11:07:31,336  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:35,169 EPOCH 15
2020-04-25 11:07:35,170  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:39,430 EPOCH 16
2020-04-25 11:07:39,431  beam_dqn : 1, egreed: 0.89, gamma:  0.84
2020-04-25 11:07:43,338 EPOCH 17
2020-04-25 11:07:43,339  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:07:47,238 EPOCH 18
2020-04-25 11:07:47,238  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:07:50,850 EPOCH 19
2020-04-25 11:07:50,851  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:07:54,310 EPOCH 20
2020-04-25 11:07:54,311  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:07:58,635 EPOCH 21
2020-04-25 11:07:58,636  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:07:58,687  As referece this first test on dev data. Is maded with the Q networks, initialized randomly : 
2020-04-25 11:07:58,757 Currently on the prediction.
2020-04-25 11:08:02,386 Optimal reward is: 99493.00
2020-04-25 11:08:02,393 On train
2020-04-25 11:08:02,393 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 11:08:02,393  3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,393  2	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,393  1 0	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,393  1	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,393  2	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,394  4	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,394  4 2	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,394  1 3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,394  4 3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,394  3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:02,440 r_total: 0.00 
2020-04-25 11:08:02,440 bleu score: 0.00
2020-04-25 11:08:11,024 EPOCH 22
2020-04-25 11:08:11,025  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:08:17,867 EPOCH 23
2020-04-25 11:08:17,868  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:08:25,556 EPOCH 24
2020-04-25 11:08:25,557  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:08:25,595  Copying the Q-Val on Q-tar on step: 1 
2020-04-25 11:08:25,685 Currently on the prediction.
2020-04-25 11:08:29,518 On train
2020-04-25 11:08:29,519 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 11:08:29,519  3	 vs 3 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,519  2	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,520  1 0	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,520  1	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,520  2	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,520  4	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,520  4 2	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,521  1 3	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,521  4 3	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,521  3	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:08:29,636 r_total: 0.00 
2020-04-25 11:08:29,637 bleu score: 0.00
2020-04-25 11:08:37,231 EPOCH 25
2020-04-25 11:08:37,232  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:08:45,375 EPOCH 26
2020-04-25 11:08:45,376  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:08:53,037 EPOCH 27
2020-04-25 11:08:53,038  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:08:53,137  Copying the Q-Val on Q-tar on step: 2 
2020-04-25 11:08:53,284 Currently on the prediction.
2020-04-25 11:08:56,132 On train
2020-04-25 11:08:56,132 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 11:08:56,132  3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  2	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  1 0	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  1	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  2	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  4	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  4 2	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  1 3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,133  4 3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,134  3	 vs 1 1 1 1 1 1 1 1 1 1	
2020-04-25 11:08:56,232 r_total: 0.00 
2020-04-25 11:08:56,233 bleu score: 0.00
2020-04-25 11:09:03,808 EPOCH 28
2020-04-25 11:09:03,809  beam_dqn : 1, egreed: 0.88, gamma:  0.84
2020-04-25 11:09:12,337 EPOCH 29
2020-04-25 11:09:12,338  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:09:20,205 EPOCH 30
2020-04-25 11:09:20,206  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:09:20,361  Copying the Q-Val on Q-tar on step: 3 
2020-04-25 11:09:20,489 Currently on the prediction.
2020-04-25 11:09:23,894 On train
2020-04-25 11:09:23,894 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 11:09:23,894  3	 vs 1 1 3	
2020-04-25 11:09:23,894  2	 vs 1 1 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,894  1 0	 vs 1 1 3	
2020-04-25 11:09:23,895  1	 vs 1 1 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,895  2	 vs 1 4 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,895  4	 vs 1 3 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,895  4 2	 vs 1 3 3 3 3 3 3 3 3 3	
2020-04-25 11:09:23,895  1 3	 vs 1 3 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,895  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,896  3	 vs 1 4 4 4 4 4 4 4 4 4	
2020-04-25 11:09:23,996 r_total: -2457.00 
2020-04-25 11:09:23,997 bleu score: 0.00
2020-04-25 11:09:32,143 EPOCH 31
2020-04-25 11:09:32,145  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:09:39,400 EPOCH 32
2020-04-25 11:09:39,401  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:09:45,936 EPOCH 33
2020-04-25 11:09:45,937  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:09:46,044  Copying the Q-Val on Q-tar on step: 4 
2020-04-25 11:09:46,079 Currently on the prediction.
2020-04-25 11:09:47,689 On train
2020-04-25 11:09:47,689 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 11:09:47,689  3	 vs 1 1	
2020-04-25 11:09:47,689  2	 vs 1 1	
2020-04-25 11:09:47,690  1 0	 vs 1 1	
2020-04-25 11:09:47,690  1	 vs 1 1	
2020-04-25 11:09:47,690  2	 vs 1	
2020-04-25 11:09:47,690  4	 vs 1	
2020-04-25 11:09:47,690  4 2	 vs 1	
2020-04-25 11:09:47,690  1 3	 vs 1	
2020-04-25 11:09:47,690  4 3	 vs 1	
2020-04-25 11:09:47,690  3	 vs 1	
2020-04-25 11:09:47,724 r_total: 4549.30 
2020-04-25 11:09:47,724 bleu score: 5.33
2020-04-25 11:09:54,096 EPOCH 34
2020-04-25 11:09:54,097  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:10:03,214 EPOCH 35
2020-04-25 11:10:03,215  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:10:12,669 EPOCH 36
2020-04-25 11:10:12,670  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:10:12,737  Copying the Q-Val on Q-tar on step: 5 
2020-04-25 11:10:12,774 Currently on the prediction.
2020-04-25 11:10:14,751 On train
2020-04-25 11:10:14,751 valid_references 	 vs 	 predicted_hypotheses
2020-04-25 11:10:14,752  3	 vs 1 0	
2020-04-25 11:10:14,752  2	 vs 1 1	
2020-04-25 11:10:14,752  1 0	 vs 1 1	
2020-04-25 11:10:14,752  1	 vs 1 1	
2020-04-25 11:10:14,752  2	 vs 1	
2020-04-25 11:10:14,752  4	 vs 1	
2020-04-25 11:10:14,752  4 2	 vs 1	
2020-04-25 11:10:14,752  1 3	 vs 1	
2020-04-25 11:10:14,752  4 3	 vs 4	
2020-04-25 11:10:14,752  3	 vs 1	
2020-04-25 11:10:14,794 r_total: 13121.49 
2020-04-25 11:10:14,794 bleu score: 9.74
2020-04-25 11:10:23,749 EPOCH 37
2020-04-25 11:10:23,750  beam_dqn : 1, egreed: 0.87, gamma:  0.84
2020-04-25 11:10:31,484 EPOCH 38
2020-04-25 11:10:31,485  beam_dqn : 1, egreed: 0.87, gamma:  0.84
