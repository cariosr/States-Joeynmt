2020-04-30 20:11:03,360 Hello! This is Joey-NMT.
2020-04-30 20:11:03,360 cfg.name                           : reverse_experiment
2020-04-30 20:11:03,360 cfg.data.src                       : src
2020-04-30 20:11:03,361 cfg.data.trg                       : trg
2020-04-30 20:11:03,361 cfg.data.train                     : test/data/mini_reverse_0/train
2020-04-30 20:11:03,361 cfg.data.dev                       : test/data/mini_reverse_0/dev
2020-04-30 20:11:03,361 cfg.data.test                      : test/data/mini_reverse_0/test
2020-04-30 20:11:03,361 cfg.data.level                     : word
2020-04-30 20:11:03,361 cfg.data.lowercase                 : False
2020-04-30 20:11:03,361 cfg.data.max_sent_length           : 25
2020-04-30 20:11:03,362 cfg.data.src_voc_min_freq          : 0
2020-04-30 20:11:03,362 cfg.data.src_voc_limit             : 100
2020-04-30 20:11:03,362 cfg.data.trg_voc_min_freq          : 0
2020-04-30 20:11:03,362 cfg.data.trg_voc_limit             : 100
2020-04-30 20:11:03,362 cfg.testing.beam_size              : 1
2020-04-30 20:11:03,362 cfg.testing.alpha                  : 1.0
2020-04-30 20:11:03,362 cfg.training.random_seed           : 42
2020-04-30 20:11:03,363 cfg.training.optimizer             : adam
2020-04-30 20:11:03,363 cfg.training.learning_rate         : 0.001
2020-04-30 20:11:03,363 cfg.training.learning_rate_min     : 0.0002
2020-04-30 20:11:03,363 cfg.training.weight_decay          : 0.0
2020-04-30 20:11:03,363 cfg.training.clip_grad_norm        : 1.0
2020-04-30 20:11:03,363 cfg.training.batch_size            : 10
2020-04-30 20:11:03,363 cfg.training.batch_type            : sentence
2020-04-30 20:11:03,363 cfg.training.scheduling            : plateau
2020-04-30 20:11:03,363 cfg.training.patience              : 5
2020-04-30 20:11:03,363 cfg.training.decrease_factor       : 0.5
2020-04-30 20:11:03,363 cfg.training.early_stopping_metric : eval_metric
2020-04-30 20:11:03,364 cfg.training.epochs                : 10
2020-04-30 20:11:03,364 cfg.training.validation_freq       : 10
2020-04-30 20:11:03,364 cfg.training.logging_freq          : 10
2020-04-30 20:11:03,364 cfg.training.eval_metric           : bleu
2020-04-30 20:11:03,364 cfg.training.model_dir             : mini_reverse_model_0
2020-04-30 20:11:03,364 cfg.training.overwrite             : True
2020-04-30 20:11:03,364 cfg.training.shuffle               : True
2020-04-30 20:11:03,364 cfg.training.use_cuda              : False
2020-04-30 20:11:03,365 cfg.training.max_output_length     : 10
2020-04-30 20:11:03,365 cfg.training.print_valid_sents     : [0, 3, 6]
2020-04-30 20:11:03,365 cfg.training.keep_last_ckpts       : 2
2020-04-30 20:11:03,365 cfg.model.initializer              : xavier
2020-04-30 20:11:03,365 cfg.model.embed_initializer        : normal
2020-04-30 20:11:03,365 cfg.model.embed_init_weight        : 0.1
2020-04-30 20:11:03,365 cfg.model.bias_initializer         : zeros
2020-04-30 20:11:03,365 cfg.model.init_rnn_orthogonal      : False
2020-04-30 20:11:03,366 cfg.model.lstm_forget_gate         : 0.0
2020-04-30 20:11:03,366 cfg.model.encoder.rnn_type         : lstm
2020-04-30 20:11:03,366 cfg.model.encoder.embeddings.embedding_dim : 16
2020-04-30 20:11:03,366 cfg.model.encoder.embeddings.scale : False
2020-04-30 20:11:03,366 cfg.model.encoder.hidden_size      : 24
2020-04-30 20:11:03,366 cfg.model.encoder.bidirectional    : True
2020-04-30 20:11:03,366 cfg.model.encoder.dropout          : 0.1
2020-04-30 20:11:03,366 cfg.model.encoder.num_layers       : 1
2020-04-30 20:11:03,366 cfg.model.decoder.rnn_type         : lstm
2020-04-30 20:11:03,366 cfg.model.decoder.embeddings.embedding_dim : 16
2020-04-30 20:11:03,367 cfg.model.decoder.embeddings.scale : False
2020-04-30 20:11:03,367 cfg.model.decoder.hidden_size      : 24
2020-04-30 20:11:03,367 cfg.model.decoder.dropout          : 0.1
2020-04-30 20:11:03,367 cfg.model.decoder.hidden_dropout   : 0.1
2020-04-30 20:11:03,367 cfg.model.decoder.num_layers       : 1
2020-04-30 20:11:03,367 cfg.model.decoder.input_feeding    : True
2020-04-30 20:11:03,367 cfg.model.decoder.init_hidden      : bridge
2020-04-30 20:11:03,367 cfg.model.decoder.attention        : luong
2020-04-30 20:11:03,368 cfg.dqn.epochs                     : 2000
2020-04-30 20:11:03,368 cfg.dqn.sample_size                : 256
2020-04-30 20:11:03,368 cfg.dqn.lr                         : 0.0001
2020-04-30 20:11:03,368 cfg.dqn.egreed_max                 : 0.9
2020-04-30 20:11:03,368 cfg.dqn.egreed_min                 : 0.001
2020-04-30 20:11:03,368 cfg.dqn.gamma_max                  : 0.9
2020-04-30 20:11:03,369 cfg.dqn.gamma_min                  : 0.3
2020-04-30 20:11:03,369 cfg.dqn.nu_iter                    : 10
2020-04-30 20:11:03,369 cfg.dqn.mem_cap                    : 4000
2020-04-30 20:11:03,369 cfg.dqn.beam_min                   : 1
2020-04-30 20:11:03,369 cfg.dqn.beam_max                   : 50
2020-04-30 20:11:03,370 cfg.dqn.state_type                 : hidden
2020-04-30 20:11:03,370 cfg.dqn.reward_type                : bleu_batch
2020-04-30 20:11:03,370 cfg.dqn.nu_pretrain                : 40
2020-04-30 20:11:03,370 cfg.dqn.N_layers                   : 4
2020-04-30 20:11:03,371 cfg.dqn.other_descrip              : _mini_reverse_with_batch
2020-04-30 20:11:03,371 We are using the reward named: bleu_batch
2020-04-30 20:11:03,371 As states we set the : hidden
2020-04-30 20:11:03,372 EPOCH 1
2020-04-30 20:11:03,373  beam_dqn : 1, egreed: 0.90, gamma:  0.60
2020-04-30 20:11:05,118 EPOCH 2
2020-04-30 20:11:05,118  beam_dqn : 1, egreed: 0.90, gamma:  0.60
2020-04-30 20:11:05,898  As referece this first test on dev data. Is maded with the Q networks, initialized randomly : 
2020-04-30 20:11:06,017 Currently on the prediction.
2020-04-30 20:11:09,811 Optimal reward is: 100000.00
2020-04-30 20:11:09,824 On train
2020-04-30 20:11:09,825 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:09,825  3	 vs 3 0 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,825  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,825  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,825  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,825  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,825  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,826  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,826  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,826  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,826  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:09,895 r_total: 4193.83 
2020-04-30 20:11:09,896 bleu score: 0.00
2020-04-30 20:11:09,897 Hooray! New best validation result [0.000000]!
2020-04-30 20:11:10,406  Copying the Q-Val on Q-tar on step: 1 
2020-04-30 20:11:10,579 Currently on the prediction.
2020-04-30 20:11:13,977 On train
2020-04-30 20:11:13,977 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:13,978  3	 vs 3 0 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,978  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,978  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,978  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,978  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,978  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,979  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,979  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,979  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:13,979  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:14,063 r_total: 4193.83 
2020-04-30 20:11:14,063 bleu score: 0.00
2020-04-30 20:11:14,590  Copying the Q-Val on Q-tar on step: 2 
2020-04-30 20:11:14,740 Currently on the prediction.
2020-04-30 20:11:19,054 On train
2020-04-30 20:11:19,054 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:19,055  3	 vs 3 0 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,055  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,055  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,055  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,055  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,056  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,056  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,056  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,056  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,056  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:19,133 r_total: 4437.43 
2020-04-30 20:11:19,134 bleu score: 0.00
2020-04-30 20:11:19,556  Copying the Q-Val on Q-tar on step: 3 
2020-04-30 20:11:19,685 Currently on the prediction.
2020-04-30 20:11:23,073 On train
2020-04-30 20:11:23,074 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:23,074  3	 vs 3 0 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,074  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,074  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,074  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,074  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,074  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,075  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,075  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,075  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,075  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:23,146 r_total: 4437.43 
2020-04-30 20:11:23,147 bleu score: 0.00
2020-04-30 20:11:23,611 EPOCH 3
2020-04-30 20:11:23,612  beam_dqn : 1, egreed: 0.90, gamma:  0.99
2020-04-30 20:11:23,652  Copying the Q-Val on Q-tar on step: 4 
2020-04-30 20:11:23,766 Currently on the prediction.
2020-04-30 20:11:27,260 On train
2020-04-30 20:11:27,261 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:27,261  3	 vs 3	
2020-04-30 20:11:27,261  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,261  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,261  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,262  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,262  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,262  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,262  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,262  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,262  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:27,366 r_total: 4748.70 
2020-04-30 20:11:27,366 bleu score: 0.00
2020-04-30 20:11:27,791  Copying the Q-Val on Q-tar on step: 5 
2020-04-30 20:11:27,957 Currently on the prediction.
2020-04-30 20:11:32,895 On train
2020-04-30 20:11:32,896 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:32,896  3	 vs 3	
2020-04-30 20:11:32,896  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,896  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,896  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,896  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,897  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,897  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,897  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,897  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,897  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:32,975 r_total: 5208.84 
2020-04-30 20:11:32,975 bleu score: 0.00
2020-04-30 20:11:33,576  Copying the Q-Val on Q-tar on step: 6 
2020-04-30 20:11:33,749 Currently on the prediction.
2020-04-30 20:11:38,919 On train
2020-04-30 20:11:38,919 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:38,920  3	 vs 3	
2020-04-30 20:11:38,920  2	 vs 4 4	
2020-04-30 20:11:38,920  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,920  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,920  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,921  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,921  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,921  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,921  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:38,921  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:39,000 r_total: 5208.84 
2020-04-30 20:11:39,000 bleu score: 0.00
2020-04-30 20:11:39,831  Copying the Q-Val on Q-tar on step: 7 
2020-04-30 20:11:40,066 Currently on the prediction.
2020-04-30 20:11:43,788 On train
2020-04-30 20:11:43,788 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:43,788  3	 vs 3	
2020-04-30 20:11:43,789  2	 vs 4 <unk>	
2020-04-30 20:11:43,789  1 0	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,789  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,789  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,789  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,789  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,789  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,789  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,790  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:43,849 r_total: 5208.84 
2020-04-30 20:11:43,849 bleu score: 0.00
2020-04-30 20:11:44,227  Copying the Q-Val on Q-tar on step: 8 
2020-04-30 20:11:44,344 Currently on the prediction.
2020-04-30 20:11:48,164 On train
2020-04-30 20:11:48,164 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:48,165  3	 vs 3	
2020-04-30 20:11:48,165  2	 vs 4 <unk>	
2020-04-30 20:11:48,165  1 0	 vs <unk> <unk> 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,165  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,165  2	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,165  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,166  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,166  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,166  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,166  3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:48,268 r_total: 5208.84 
2020-04-30 20:11:48,268 bleu score: 0.00
2020-04-30 20:11:49,160  Copying the Q-Val on Q-tar on step: 9 
2020-04-30 20:11:49,344 Currently on the prediction.
2020-04-30 20:11:52,563 On train
2020-04-30 20:11:52,564 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:52,564  3	 vs 3	
2020-04-30 20:11:52,564  2	 vs 4 <unk>	
2020-04-30 20:11:52,564  1 0	 vs <unk> <unk> 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,564  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,565  2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,565  4	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,565  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,565  1 3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,565  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,565  3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:52,633 r_total: 5208.84 
2020-04-30 20:11:52,633 bleu score: 0.00
2020-04-30 20:11:53,142  Copying the Q-Val on Q-tar on step: 10 
2020-04-30 20:11:53,282 Currently on the prediction.
2020-04-30 20:11:56,395 On train
2020-04-30 20:11:56,395 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:11:56,395  3	 vs 	
2020-04-30 20:11:56,396  2	 vs 4 <unk>	
2020-04-30 20:11:56,396  1 0	 vs <unk> <unk> 4 4 4 4 4 4 4 4	
2020-04-30 20:11:56,396  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:56,396  2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:56,396  4	 vs <unk>	
2020-04-30 20:11:56,396  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:56,396  1 3	 vs <unk>	
2020-04-30 20:11:56,396  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:56,396  3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:11:56,452 r_total: 5425.38 
2020-04-30 20:11:56,452 bleu score: 0.00
2020-04-30 20:11:56,918  Copying the Q-Val on Q-tar on step: 11 
2020-04-30 20:11:57,056 Currently on the prediction.
2020-04-30 20:12:01,324 On train
2020-04-30 20:12:01,325 valid_references 	 vs 	 predicted_hypotheses
2020-04-30 20:12:01,325  3	 vs 	
2020-04-30 20:12:01,325  2	 vs 4 <unk>	
2020-04-30 20:12:01,325  1 0	 vs <unk> <unk> 4 4 4 4 4 4 4 4	
2020-04-30 20:12:01,326  1	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:12:01,326  2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:12:01,326  4	 vs <unk>	
2020-04-30 20:12:01,326  4 2	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:12:01,326  1 3	 vs <unk>	
2020-04-30 20:12:01,326  4 3	 vs 4 4 4 4 4 4 4 4 4 4	
2020-04-30 20:12:01,326  3	 vs <unk> 4 4 4 4 4 4 4 4 4	
2020-04-30 20:12:01,418 r_total: 5425.38 
2020-04-30 20:12:01,426 bleu score: 0.00
2020-04-30 20:12:02,375  Copying the Q-Val on Q-tar on step: 12 
2020-04-30 20:12:02,575 Currently on the prediction.
